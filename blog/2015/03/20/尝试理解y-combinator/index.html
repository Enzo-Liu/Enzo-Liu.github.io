<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>å°è¯•ç†è§£Y-combinator - enzo&#39;s note book</title>
    <meta charset="utf-8" />
    <meta name="author" content="enzo liu" />
    <link rel="stylesheet" href="/media/css/main.css" type="text/css">
    <link rel="stylesheet" href="/media/css/prettify.css" type="text/css">
  </head>
  <body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title"><a href="/">enzo&#39;s note book</a></h1>
        <p>M-x (sketch for random ideas)</p>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/history/">History</a></li>
          <li><a href="/leetcode/">Leetcode</a></li>
          <li><a href="/tags/">Tags</a></li>
          <li><a href="/about/">About</a></li>
          <li><a href="https://github.com/Enzo-Liu">GitHub</a></li>
          <li><a href="/rss.xml">RSS</a></li>
        </ul>
        <form method="get" id="searchform" action="//www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="as_sitesearch" value="blog.enzo.cc">
        </form>
      </header>
    </div>

<div>
<div class="post">
<h1>å°è¯•ç†è§£Y-combinator</h1>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">ç®€ä»‹</h2>
<div class="outline-text-2" id="text-1">
<p>
åœ¨ä¸€ä¸ªçº¯ç²¹çš„å‡½æ•°å¼è¯­è¨€ç¯å¢ƒä¸­ï¼Œåªæœ‰ä¸€ç§å…ƒç´ ï¼Œå°±æ˜¯ä¸€ä¸ªå•å‚å‡½æ•°
</p>

<div class="org-src-container">

<pre class="src src-lisp">;; id function
(lambda (x) x)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-haskell">-- id function in haskll
\x -&gt; x
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">é—®é¢˜</h2>
<div class="outline-text-2" id="text-2">
<p>
æ¯”å¦‚éœ€è¦æ±‚è§£ä¸€ä¸ªåˆ—è¡¨çš„é•¿åº¦ï¼Œè¯¥å¦‚ä½•å®ç°ã€‚
</p>

<p>
ç®—æ³•è§„åˆ™å¾ˆç®€å•ï¼š &gt; 1. ç©ºåˆ—è¡¨é•¿åº¦ä¸º0 &gt; 2. åˆ—è¡¨é•¿åº¦ç­‰äº 1 +
åˆ—è¡¨é™¤äº†å¤´éƒ¨å…ƒç´ ä»¥å¤–çš„éƒ¨åˆ†
</p>

<p>
å¸¸è§„çš„ç®—æ³•å®ç°å¦‚ä¸‹:
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">common lisp</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-lisp">;; in common lisp
(defun len (ls)
  (if (null ls)
      0
      (1+ (len (cdr ls)))))
</pre>
</div>

<pre class="example">
CL-USER&gt; (len '(1 2 3))
3
CL-USER&gt; (len '())
0
</pre>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">haskell</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-haskell">len1 :: (Num b ) =&gt; [a] -&gt; b
len1 [] = 0
len1 (_:xs) = 1 + len1 xs
</pre>
</div>

<pre class="example">
Î»&gt; len1 []
0
Î»&gt; len1 [1,2,3]
3
</pre>

<p>
ä½†æ˜¯ï¼Œå¦‚ä½•åŸºäºçº¯ç²¹çš„lambdaè¡¨è¾¾å¼å®ç°å‘¢ï¼Ÿ
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">ç¬¬ä¸€æ¬¡å°è¯•</h2>
<div class="outline-text-2" id="text-3">
<p>
å°è¯•ç¿»è¯‘ä¹‹å‰å†™è¿‡çš„å®ç°
</p>

<div class="org-src-container">

<pre class="src src-lisp">(lambda (ls)
  (if (null ls)
      0
      (1+ (?? (cdr ls)))))
</pre>
</div>

<p>
*æ€ä¹ˆåŠ*ï¼Œ=?= éƒ¨åˆ†æ— æ³•å¡«å……ã€‚å› ä¸ºç°åœ¨è¿™ä¸ªåŒ¿åå‡½æ•°æœ¨æœ‰åå­—
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">ç¥æ¥ä¸€ç¬”</h3>
<div class="outline-text-3" id="text-3-1">
<p>
å‡å¦‚æœ‰ä¸€ä¸ªlençš„å®ç°ï¼Œä¸å°±å¯ä»¥äº†ä¹ˆï¼ï¼ï¼ï¼
</p>

<div class="org-src-container">

<pre class="src src-lisp">(lambda (perfectLenFunc)
  (lambda (ls)
    (if (null ls)
        0
        (1+ (perfectLenFunc (cdr ls))))))
</pre>
</div>

<p>
å“‡æ“¦ï¼Œè¦æ˜¯æœ‰=perfectLenFunc=(åç»­ç®€å†™ä¸º=plf=&#x2026;),è¿˜åœ¨è¿™é‡Œæµªè´¹æ—¶é—´å¹²ç¥é©¬ã€‚
</p>

<p>
*å’³å’³*ï¼Œä¸æ€¥
</p>

<div class="org-src-container">

<pre class="src src-lisp">;; change to scheme, due to the function namespace
(define len1
    ((lambda (plf)
    (lambda (ls)
        (if (null? ls)
            0
            (1+ (plf (cdr ls))))))
    (lambda (ls)
    (if (null? ls)
        0
        (1+ (error (cdr ls)))))))
</pre>
</div>

<pre class="example">
scheme@(guile-user)&gt; (len1 '())
$3 = 0
scheme@(guile-user)&gt; (len1 '(a))
$4 = 1
scheme@(guile-user)&gt; (len1 '(a b))
ERROR: In procedure scm-error:
ERROR: ()
</pre>

<p>
å’¦ï¼Œè¿™æ ·å°±å¯ä»¥æ”¯æŒé•¿åº¦ä¸º0çš„åˆ—è¡¨å’Œé•¿åº¦ä¸º1çš„åˆ—è¡¨å’§ã€‚
</p>

<p>
æ•´ä½“ä¼˜åŒ–ä¸€ä¸‹é‡å¤ä»£ç 
</p>

<div class="org-src-container">

<pre class="src src-lisp">(define mk-len
  (lambda (plf)
    (lambda (ls)
        (if (null? ls)
            0
        (1+ (plf (cdr ls)))))))
(define len0 (mk-len error))
(define len1 (mk-len len0))
(define len2 (mk-len len1))
;; output
scheme@(guile-user)&gt;
(define len0 (mk-len error))
(define len1 (mk-len len0))
(define len2 (mk-len len1))
scheme@(guile-user)&gt; (len2 '(1 2))
$6 = 2
</pre>
</div>

<p>
çœ‹æ¥,åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œåªè¦è¶³å¤ŸåŠªåŠ›,
ä¸ç®¡å¤šé•¿çš„åˆ—è¡¨ï¼Œéƒ½èƒ½å†™å‡ºå¯¹åº”çš„å‡½æ•°ç®—å‡ºæ¥ï¼ &gt; å¤ªå¤©çœŸäº†å°‘å¹´ ï¼ˆç”»å¤–éŸ³ï¼‰
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">ç¥åˆæ¥ä¸€ç¬”</h3>
<div class="outline-text-3" id="text-3-2">
<p>
æ—¶é—´è¿‡å»äº†ä¸€å¹´ï¼Œå°‘å¹´ç»ˆäºå†™å‡ºäº†å¯ä»¥è®¡ç®—é•¿åº¦
=14239823586=ä»¥å†…çš„åˆ—è¡¨çš„é•¿åº¦ï¼
</p>

<p>
çªç„¶ä¸€ä¸ªéœ¹é›³ä»å¤©è€Œé™ &gt; ä½ ä¸ªXXï¼Œæƒ³å†™åˆ°æ­»å•Šï¼ï¼ï¼ï¼ (ç”»å¤–éŸ³again)
</p>

<p>
å’¦ï¼Œæ³¨æ„ <code>(define len0 (mk-len error))</code>,
=error=è€¶ï¼Œå²‚ä¸æ˜¯è¯´ä¸ç®¡æä¾›ç¥é©¬å‡½æ•°,éƒ½ ä¸å½±å“ä¹ˆ
</p>

<div class="org-src-container">

<pre class="src src-lisp">(define len2 (mk-len (mk-len (mk-len mk-len))))
;; output
scheme@(guile-user)&gt;
(define len2 (mk-len (mk-len (mk-len mk-len))))
scheme@(guile-user)&gt; (len2 '(1 2))
$8 = 2
</pre>
</div>

<p>
<b>å“‡ï¼Œé‚£å²‚ä¸æ˜¯å¯ä»¥è¿™æ ·ï¼ï¼ï¼</b>
</p>

<div class="org-src-container">

<pre class="src src-lisp">(define real-len
  ((lambda (mk-len)
     (mk-len mk-len))
   (lambda (mk-len)
     (lambda (l)
       (if (null? l) 0
         (1+ ((mk-len mk-len) (cdr l))))))))
scheme@(guile-user)&gt; (real-len '(1 2 3 a b d c s))
$9 = 8
</pre>
</div>

<p>
å¥½æ£’ï¼å¥½é™¶é†‰ï¼å¥½æ»¡è¶³ï¼ï¼ï¼
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">ç¥åˆæ¥ä¸€ç¬”!</h3>
<div class="outline-text-3" id="text-3-3">
<p>
ä¸è¿‡ï¼Œå†™å‡ºæ¥çš„ç¨‹åºçœ‹ç€å¥½å¥‡æ€ªã€‚å¥½å¤š=mk-len=,=ï¼ˆmk-len mk-lenï¼‰=,
<b>çœ‹ä¸æ‡‚å•Š</b>. åªæœ‰
</p>

<div class="org-src-container">

<pre class="src src-lisp">(lambda (l)
  (if (null? l) 0
    (1+ (?? (cdr l))))))))
</pre>
</div>

<p>
è¿™ä¸ªæ‰æ˜¯æˆ‘æƒ³è¦çš„å‘¢&#x2026; é‚£å°±æƒ³åŠæ³•æŠŠ=(mklen mklen)=
æå‡ºå»ï¼Œåšå‚æ•°ä¼ è¿›æ¥å¥½äº†ğŸ‘Œ
</p>

<div class="org-src-container">

<pre class="src src-lisp">((lambda (mk-len)
   (mk-len mk-len))
 (lambda (mk-len)
   ((lambda (len)
      (lambda (l)
        (if (null? l) 0
          (1+ (len (cdr l))))))
    (lambda (x) ((mk-len mk-len) x)))))
</pre>
</div>

<p>
å“‡ï¼Œä¸­é—´çš„ä»£ç çœ‹èµ·æ¥ï¼Œæœ‰ç‚¹åƒé‚£ä¹ˆä¸€å›äº‹äº†ã€‚æƒ³åŠæ³•æŒªæŒªç»“æ„ï¼Œæ›´å¥½çœ‹ä¸€ç‚¹ã€‚
</p>

<div class="org-src-container">

<pre class="src src-lisp">((lambda (len')
   ((lambda (mk-len) (mk-len mk-len))
    (lambda (mk-len) (len' (lambda (x) ((mk-len mk-len) x))))))
 (lambda (len)
   (lambda (l)
     (if (null? l) 0
       (1+ (len (cdr l)))))))
</pre>
</div>

<p>
<b>BINGO</b> !!
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">the ultimate Y-Combinator</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">

<pre class="src src-lisp">(define Y
  (lambda (targetFunction)
    ((lambda (f) (f f))
     (lambda (f) (targetFunction (lambda (x) ((f f) x)))))))

(define len
  ( Y (lambda (len')
        (lambda (l)
          (if (null? l) 0
            (1+ (len' (cdr l))))))))
;; output
scheme@(guile-user)&gt; (len '(a b d c dd s sf ad f))
$10 = 9
</pre>
</div>

<p>
<b>ç‚«é…·çˆ†æ£šäº†!</b> æœ‰æ²¡æœ‰
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">å®è·µ</h2>
<div class="outline-text-2" id="text-5">
<p>
in haskell
</p>

<div class="org-src-container">

<pre class="src src-haskell">-- here is where miracle begins
newtype Rec a = In { out :: Rec a -&gt; a } -- for type deduction

y :: (a -&gt; a) -&gt; a
y tf = (\f -&gt; out f f) $In (\f -&gt; tf (out f f))


ylen :: (Num b) =&gt; [a]-&gt;b
ylen = y (\len' ls -&gt; if null ls then 0 else (len'.tail$ls)+1)

ysum :: (Num a) =&gt; [a] -&gt; a
ysum = y (\sum' ls -&gt; if null ls then 0 else head ls + (sum'.tail $ ls))
-- output
Î»&gt; ylen [1,2,3,4]
4
Î»&gt; ysum [1,2,3,4]
10
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">external links</h2>
<div class="outline-text-2" id="text-6">
<p>
<a href="http://en.wikipedia.org/wiki/Fixed-point_combinator#Y_combinator">y-combinator
in wikipedia</a>
</p>

<p>
<a href="http://mitpress.mit.edu/books/little-schemer">the litter scheme -
chapter 8</a>
</p>
</div>
</div>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2015-03-20</span>
        <span title="last modification date" class="post-info">2016-02-03</span>
        <span title="tags" class="post-info"><a href="/tags/lisp/">lisp</a>, <a href="/tags/haskell/">haskell</a>, <a href="/tags/y-combinator/">y-combinator</a>, <a href="/tags/lambda/">lambda</a></span>
        <span title="author" class="post-info">enzo liu</span>
      </div>
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          //var disqus_developer = 1;
          var disqus_identifier = "/blog/2015/03/20/å°è¯•ç†è§£y-combinator/";
          var disqus_url = "https://blog.enzo.cc/blog/2015/03/20/å°è¯•ç†è§£y-combinator/";
          var disqus_shortname = 'enzo-liu';
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </section>
      <script src="//code.jquery.com/jquery-latest.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="/media/js/main.js"></script>
      <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.x (<a href="http://orgmode.org">Org mode</a> 8.x)</p>
        <p>
          Copyright &copy; 2012 - <span id="footerYear"></span> <a href="mailto:liuenze6516 &lt;at&gt; gmail &lt;dot&gt; com">enzo liu</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
          <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
      </div>
    </div>

  </body>
</html>
