#+TITLE: 拼团活动技术方案
#+AUTHOR: 刘恩泽
#+EMAIL:  enze.liu@ipiaoniu.com
#+DATE: 2016-02-02
#+OPTIONS:   H:2 toc:t num:t \n:nil @:t ::t |:t ^:t -:t f:t *:t <:t
#+OPTIONS:   TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:not-in-toc
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport
#+startup: beamer
#+LaTeX_CLASS: beamer
#+LaTeX_CLASS_OPTIONS: [presentation, bigger]
#+COLUMNS: %40ITEM %10BEAMER_env(Env) %9BEAMER_envargs(Env Args) %4BEAMER_col(Col) %10BEAMER_extra(Extra)
#+BEAMER_THEME: metropolis
#+BIND: org-beamer-outline-frame-title "目录"


* 活动分析

** 活动分析

1. 针对活动演出，提供两个商品，一个原价商品，一个团购商品
2. 对于团购商品的购买，订单支付之后，需要延迟发货相关的流程。
3. 团购商品的订单，支付后，可以获取分享的团购标识.
4. 在时效范围内且参团人数未满，都可以参加该团购的购买
5. 一次开团成功后，所有相关订单开始备货发货流程
6. 一次开团失败后，所有相关订单走退款流程


* 功能列表

** 接口交互

1. 活动演出列表
2. 活动演出详情
3. 参团详情
4. 获取团购标识


** 后台逻辑

1. 标记特卖商品 (普通售卖不可见)
2. 配置团购商品的汇总关系 (列表页数据)
3. 购买时根据团购商品区分不同的发货
4. 根据团购订单生成开团标识
5. 定期根据团购标识处理发货或者退款


* 后台接口列表
1. 根据活动 ID 拿商品列表
2. 根据商品拿详情
3. 根据用户和商品获取拼团信息
4. 参加/发起一个拼团

* 生命周期

** 创建
- 创建团
- 加入团

** 支付
- 加入团成功

** 订单关闭
- 加入团失败

** 订单退款
- 加入团失败

** 团成功

** 团失败


* 场景
** 页面入口的场景

| 人         | 团 | 团状态             | 操作         | 提示           |
|------------+----+--------------------+--------------+----------------|
| 参加过团 A | B  |                    | 不能做任何事 | 已参加过一个团 |
| 参加过团 A | A  | 未结束             | 只能分享     |                |
| 参加过团 A | A  | 成功               | 不能做任何事 |                |
| 参加过团 A | A  | 失败               | 创建新的团   |                |
| 未参加过   | /  | /                  | 创建新的团   |                |
| 未参加过   | A  | 进行中             | 参加该团     |                |
| 未参加过   | A  | 结束（成功、失败） | 创建新的团   |                |
